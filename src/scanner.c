#include "tree_sitter/parser.h"
#include <ctype.h>
#include <stdbool.h>
#include <stddef.h>
#include <string.h>

// The external token produced by this scanner.
// (Note: our grammar.js expects an external $.id, so you might choose to name
// this ID.)
enum TokenType {
  ID,
  SUBID,
  KEY,
};

//---------------------------------------------------------------------
// The list of SPSS command names.
static const char *command_list[] = {
    "2SLS",
    "ACF",
    "ADD DOCUMENT",
    "ADD FILES",
    "ADD VALUE LABELS",
    "ADP",
    "AGGREGATE",
    "AIM",
    "ALSCAL",
    "ALTER TYPE",
    "ANACOR",
    "ANOVA",
    "APPLY DICTIONARY",
    "AREG",
    "ARIMA",
    "AUTORECODE",
    "BAYES ANOVA",
    "BAYES CORRELATION",
    "BAYES INDEPENDENT",
    "BAYES LOGLINEAR",
    "BAYES ONESAMPLE",
    "BAYES ONESAMPLE",
    "BAYES ONESAMPLE",
    "BAYES REGRESSION",
    "BAYES RELATED",
    "BAYES REPEATED",
    "BEGIN DATA",
    "BEGIN EXPR",
    "BEGIN EXPR-END EXPR",
    "BEGIN GPL-END GPL",
    "BOOTSTRAP",
    "BREAK",
    "CACHE",
    "CASEPLOT",
    "CASESTOVARS",
    "CATREG",
    "CD",
    "CLABELS",
    "CLEAR TIME PROGRAM",
    "CLEAR TRANSFORMATIONS",
    "CLUSTER",
    "CNLR",
    "CODEBOOK",
    "COMPARE DATASETS",
    "COMPUTE",
    "CONJOINT",
    "CONSTRAINED FUNCTIONS",
    "CORRELATIONS",
    "CORRESPONDENCE",
    "COUNT",
    "COXREG",
    "CREATE",
    "CROSSTABS",
    "CSCOXREG",
    "CSDESCRIPTIVES",
    "CSGLM",
    "CSLOGISTIC",
    "CSORDINAL",
    "CSPLAN",
    "CSSELECT",
    "CSTABULATE",
    "CTABLES",
    "CURVEFIT",
    "DATA LIST",
    "DATAFILE ATTRIBUTE",
    "DATASET ACTIVATE",
    "DATASET CLOSE",
    "DATASET COPY",
    "DATASET DECLARE",
    "DATASET DISPLAY",
    "DATASET NAME",
    "DATE",
    "DEFINE",
    "DELETE VARIABLES",
    "DERIVATIVES",
    "DESCRIPTIVES",
    "DETECTANOMALY",
    "DISCRIMINANT",
    "DISPLAY",
    "DO IF",
    "DO REPEAT",
    "DOCUMENT",
    "DROP DOCUMENTS",
    "ECHO",
    "END CASE",
    "END FILE",
    "ERASE",
    "EXAMINE",
    "EXECUTE",
    "EXPORT",
    "EXSMOOTH",
    "EXTENSION",
    "FACTOR",
    "FILE HANDLE",
    "FILE LABEL",
    "FILE TYPE",
    "FILTER",
    "FINISH",
    "FIT",
    "FLEISS MULTIRATER KAPPA",
    "FLIP",
    "FORMATS",
    "FREQUENCIES",
    "GENLIN",
    "GENLINMIXED",
    "GENLOG",
    "GET",
    "GET CAPTURE",
    "GET DATA",
    "GET SAS",
    "GET STATA",
    "GET TRANSLATE",
    "GETCOGNOS",
    "GETTM1",
    "GGRAPH",
    "GLM",
    "GRAPH",
    "HILOGLINEAR",
    "HOMALS",
    "HOST",
    "IBREAK",
    "IDO",
    "IDOEND",
    "IGRAPH",
    "IIF",
    "IIFEND",
    "ILET",
    "IMPORT",
    "INCLUDE",
    "INPUT PROGRAM",
    "INSERT",
    "INSERT EXEC",
    "INSERT EXEC",
    "INSERT HIDDDEN",
    "INSERT HIDDEN",
    "KEYED DATA LIST",
    "KM",
    "KNN",
    "LINEAR",
    "LIST",
    "LOGISTIC REGRESSION",
    "LOGLINEAR",
    "LOOP",
    "MANOVA",
    "MATCH FILES",
    "MATRIX",
    "MATRIX DATA",
    "MCONVERT",
    "MEANS",
    "MISSING VALUES",
    "MIXED",
    "MLP",
    "MODEL CLOSE",
    "MODEL HANDLE",
    "MODEL LIST",
    "MODEL NAME",
    "MODEL PROGRAM",
    "MRSETS",
    "MULT RESPONSE",
    "MULTIPLE CORRESPONDENCE",
    "MULTIPLE IMPUTATION",
    "MVA",
    "N OF CASES",
    "NAIVEBAYES",
    "NEW FILE",
    "NLR",
    "NOMREG",
    "NONPAR CORR",
    "NPAR TESTS",
    "NPTESTS",
    "NUMERIC",
    "OLAP CUBES",
    "OMS",
    "OMSEND",
    "OMSINFO",
    "OMSLOG",
    "ONEWAY",
    "OPTIMAL BINNING",
    "ORTHOPLAN",
    "OUTPUT MODIFY",
    "OUTPUT NAME",
    "OUTPUT NEW",
    "OUTPUT OPEN",
    "OUTPUT SAVE",
    "OVERALS",
    "PACF",
    "PARTIAL CORR",
    "PERMISSIONS",
    "PLANCARDS",
    "PLS",
    "PLUM",
    "POINT",
    "POWER MEANS INDEPENDENT",
    "POWER MEANS INDEPENDENT",
    "POWER MEANS ONESAMPLE",
    "POWER MEANS ONESAMPLE",
    "POWER MEANS RELATED",
    "POWER MEANS RELATED",
    "POWER ONEWAY ANOVA",
    "POWER ONEWAY ANOVA",
    "POWER PARTIALCORR",
    "POWER PARTIALCORR",
    "POWER PEARSON ONESAMPLE",
    "POWER PEARSON ONESAMPLE",
    "POWER PROPORTIONS INDEPENDENT",
    "POWER PROPORTIONS INDEPENDENT",
    "POWER PROPORTIONS ONESAMPLE",
    "POWER PROPORTIONS ONESAMPLE",
    "POWER PROPORTIONS RELATED",
    "POWER PROPORTIONS RELATED",
    "POWER SPEARMAN ONESAMPLE",
    "POWER SPEARMAN ONESAMPLE",
    "POWER UNIVARIATE LINEAR",
    "POWER UNIVARIATE LINEAR",
    "PPLOT",
    "PREDICT",
    "PREFSCAL",
    "PRESERVE",
    "PRINCALS",
    "PRINT",
    "PRINT EJECT",
    "PRINT FORMATS",
    "PRINT SPACE",
    "PROBIT",
    "PROCEDURE OUTPUT",
    "PROPORTIONS",
    "PROXIMITIES",
    "PROXSCAL",
    "QUANTILE REGRESSION",
    "QUICK CLUSTER",
    "RANK",
    "RATIO STATISTICS",
    "RBF",
    "READ MODEL",
    "RECODE",
    "RECORD TYPE",
    "REGRESSION",
    "RELIABILITY",
    "RENAME",
    "RENAME VARIABLES",
    "REPEATING DATA",
    "REPORT",
    "REPOSITORY ATTRIBUTES",
    "REPOSITORY CONNECT",
    "REPOSITORY COPY",
    "REREAD",
    "RESPONSE RATE",
    "RESTORE",
    "RMV",
    "ROC",
    "ROC ANALYSIS",
    "ROC ANALYSIS",
    "SAMPLE",
    "SAVE",
    "SAVE CODEPAGE",
    "SAVE CODEPAGE",
    "SAVE DATA COLLECTION",
    "SAVE MODEL",
    "SAVE TRANSLATE",
    "SCRIPT",
    "SEASON",
    "SELECT IF",
    "SELECTPRED",
    "SET",
    "SHIFT VALUES",
    "SHOW",
    "SIMPLAN",
    "SIMPREP BEGIN",
    "SIMRUN",
    "SORT",
    "SORT CASES",
    "SORT VARIABLES",
    "SPATIAL ASSOCIATION RULES",
    "SPATIAL ASSOCIATION RULES",
    "SPATIAL MAPSPEC",
    "SPATIAL MAPSPEC",
    "SPATIAL TEMPORAL PREDICTION",
    "SPATIAL TEMPORAL PREDICTION",
    "SPCHART",
    "SPECTRA",
    "SPLIT FILE",
    "STAR JOIN",
    "STRING",
    "SUBTITLE",
    "SUMMARIZE",
    "SURVIVAL",
    "SYSFILE INFO",
    "T-TEST",
    "TCM ANALYSIS",
    "TCM APPLY",
    "TCM MODEL",
    "TDISPLAY",
    "TEMPORARY",
    "TIME PROGRAM",
    "TITLE",
    "TMS BEGIN",
    "TMS END",
    "TMS IMPORT",
    "TMS MERGE",
    "TREE",
    "TSAPPLY",
    "TSET",
    "TSHOW",
    "TSMODEL",
    "TSPLOT",
    "TWOSTEP CLUSTER",
    "UNIANOVA",
    "UPDATE",
    "USE",
    "VALIDATEDATA",
    "VALUE LABELS",
    "VARCOMP",
    "VARIABLE ALIGNMENT",
    "VARIABLE ATTRIBUTE",
    "VARIABLE LABELS",
    "VARIABLE LEVEL",
    "VARIABLE ROLE",
    "VARIABLE WIDTH",
    "VARSTOCASES",
    "VECTOR",
    "VERIFY",
    "WEIGHT",
    "WEIGHTED KAPPA",
    "WLS",
    "WRITE",
    "WRITE FORMATS",
    "XGRAPH",
    "XSAVE",
};

//---------------------------------------------------------------------
// The list of SPSS subcommand names.
static const char *subcommand_list[] = {"$VARS",
                                        "ACCELERATION",
                                        "ADJUSTLEVEL",
                                        "AGGREGATION",
                                        "ALPHA",
                                        "ANALYSIS",
                                        "ANALYSISWEIGHT",
                                        "APPEND",
                                        "APPLY",
                                        "APPLY TEMPLATE",
                                        "AR",
                                        "ARCHITECTURE",
                                        "ARIMA",
                                        "ARRANGEMENT",
                                        "ASSUMEDSTRWIDTH",
                                        "AUTOBINNING",
                                        "AUTOFIT",
                                        "AUTOFIX",
                                        "AUTOOUTLIER",
                                        "AUXILIARY",
                                        "BAR",
                                        "BARCHART",
                                        "BASE",
                                        "BASETEXTDIRECTION",
                                        "BIN",
                                        "BINOMIAL",
                                        "BLANK",
                                        "BLANKS",
                                        "BLOCK",
                                        "BMP",
                                        "BOOTSTRAP",
                                        "BOUNDS",
                                        "BOX",
                                        "BOXPLOT",
                                        "BREAK",
                                        "BUILDOPTIONS",
                                        "BUILD_OPTIONS",
                                        "BULKLOADING",
                                        "BY",
                                        "C",
                                        "CACHE",
                                        "CALCULATE",
                                        "CAPSIGMA",
                                        "CAPTION",
                                        "CASE",
                                        "CASECHECKS",
                                        "CASEID",
                                        "CASELABEL",
                                        "CASELABELS",
                                        "CASEREPORT",
                                        "CASES",
                                        "CASEWISE",
                                        "CATEGORICAL",
                                        "CC",
                                        "CELLRANGE",
                                        "CELLS",
                                        "CELLSBREAK",
                                        "CENTER",
                                        "CHAID",
                                        "CHART",
                                        "CHARTLOOK",
                                        "CHISQUARE",
                                        "CI",
                                        "CIN",
                                        "CINPCT",
                                        "CINTERVAL",
                                        "CLABELS",
                                        "CLASSIFY",
                                        "CLASSMISSING",
                                        "CLASSPLOT",
                                        "CLEAR",
                                        "CMPTRANS",
                                        "COCHRAN",
                                        "COLOR",
                                        "COLORCYCLE",
                                        "COLUMN",
                                        "COLUMNS",
                                        "COMPARE",
                                        "COMPARETEST",
                                        "COMPDATASET",
                                        "COMPRESSED",
                                        "CON",
                                        "CONDITION",
                                        "CONFIGURATION",
                                        "CONFORM",
                                        "CONNECT",
                                        "CONNECTION",
                                        "CONSTANT",
                                        "CONSTRAINTS",
                                        "CONTENTS",
                                        "CONTINGENCY",
                                        "CONTINUED",
                                        "CONTINUOUS",
                                        "CONTRAST",
                                        "CONVERGENCE",
                                        "COORDINATE",
                                        "CORRELATIONS",
                                        "COSTS",
                                        "COUNT",
                                        "COVARIATES",
                                        "CPCHART",
                                        "CREATE",
                                        "CRITERIA",
                                        "CRITITER",
                                        "CROSS",
                                        "CROSSTAB",
                                        "CROSSVALIDATION",
                                        "CRT",
                                        "CSTRUCTURE",
                                        "CTEMPLATE",
                                        "CUBE",
                                        "CUSTOM",
                                        "CWEIGHT",
                                        "D",
                                        "DATA",
                                        "DATAFILTER",
                                        "DATASET",
                                        "DATASETTINGS",
                                        "DATATYPEMIN",
                                        "DATA_STRUCTURE",
                                        "DECIMAL",
                                        "DEFAULT",
                                        "DEFOLANG",
                                        "DELCASE",
                                        "DELETEOBJECT",
                                        "DELIMITERS",
                                        "DELTA",
                                        "DEPCATEGORIES",
                                        "DEPENDENT",
                                        "DESCENDING",
                                        "DESCRIPTIVES",
                                        "DESIGN",
                                        "DESTINATION",
                                        "DFE",
                                        "DFH",
                                        "DIAGONAL",
                                        "DIFF",
                                        "DIGITGROUPING",
                                        "DIGITS",
                                        "DIMENSION",
                                        "DISCRETIZATION",
                                        "DISCRIM",
                                        "DISPLAY",
                                        "DISTANCE",
                                        "DISTRIBUTION",
                                        "DOC",
                                        "DOCUMENT",
                                        "DOMAIN",
                                        "DPATTERN",
                                        "DROP",
                                        "DUPLICATE",
                                        "EDITION",
                                        "EFFECT",
                                        "EM",
                                        "EMF",
                                        "EMMEANS",
                                        "EMMEANS_OPTIONS",
                                        "ENCODING",
                                        "ENCRYPTED",
                                        "ENCRYYPTED",
                                        "END",
                                        "ENDOGENOUS",
                                        "ENSEMBLES",
                                        "EPS",
                                        "EQUAL",
                                        "EQUATION",
                                        "ERROR",
                                        "ERRORBAR",
                                        "ERRORS",
                                        "ES",
                                        "ESTBF",
                                        "ESTIMATOR",
                                        "EXCELOPTIONS",
                                        "EXCEPT",
                                        "EXCEPTIF",
                                        "EXPERTMODELER",
                                        "EXPRESSIONS",
                                        "EXSMOOTH",
                                        "EXTENSIONS",
                                        "EXTERNAL",
                                        "EXTPATHS",
                                        "EXTRACTION",
                                        "FACTORS",
                                        "FAILURE",
                                        "FIELDNAMES",
                                        "FIELDS",
                                        "FIELDSGROUP",
                                        "FILE",
                                        "FILEINFO",
                                        "FILTER",
                                        "FILTEREDOUTPUT",
                                        "FIRST",
                                        "FIRSTCASE",
                                        "FITLINE",
                                        "FITLINES",
                                        "FIXCASE",
                                        "FIXED",
                                        "FIXEDINPUT",
                                        "FOCALCASES",
                                        "FOOTER",
                                        "FOOTNOTE",
                                        "FORCE",
                                        "FORECAST",
                                        "FORMAT",
                                        "FORMATS",
                                        "FRACTION",
                                        "FRAME",
                                        "FREQUENCIES",
                                        "FRIEDMAN",
                                        "FROM",
                                        "FTEST",
                                        "FULLFACTORIAL",
                                        "FUZZBITS",
                                        "GAIN",
                                        "GAMMA",
                                        "GLOR",
                                        "GRAPHDATASET",
                                        "GRAPHS",
                                        "GRAPHSPEC",
                                        "GRESID",
                                        "GRIDLINES",
                                        "GROUP",
                                        "GROUPBY",
                                        "GROUPED",
                                        "GROUPS",
                                        "GROWTHLIMIT",
                                        "HANDLEMISSING",
                                        "HANDLENOISE",
                                        "HANDLES",
                                        "HEADER",
                                        "HIDDEN",
                                        "HIDESMALLCOUNTS",
                                        "HILO",
                                        "HISTOGRAM",
                                        "HISTORY",
                                        "HOLDOUT",
                                        "HTML",
                                        "I",
                                        "ICC",
                                        "ID",
                                        "IDCHECKS",
                                        "IF",
                                        "IMPORT",
                                        "IMPORTCASE",
                                        "IMPUTATIONSUMMARIES",
                                        "IMPUTE",
                                        "IN",
                                        "INCLPROB",
                                        "INDEPENDENT",
                                        "INDEPENDENTSAMPLES",
                                        "INDEX",
                                        "INDEXING",
                                        "INFERENCE",
                                        "INFILE",
                                        "INFLUENCE",
                                        "INITIAL",
                                        "INPUT",
                                        "INSTRUMENTS",
                                        "INTERCEPT",
                                        "INTERVAL",
                                        "INTO",
                                        "IR",
                                        "JOIN",
                                        "JOINTPROB",
                                        "JOURNAL",
                                        "JPG",
                                        "K-S",
                                        "KEEP",
                                        "KENDALL",
                                        "KEY",
                                        "KMATRIX",
                                        "KS_SIM",
                                        "LAST",
                                        "LEADINGSPACES",
                                        "LEADZERO",
                                        "LENGTH",
                                        "LEVEL",
                                        "LINE",
                                        "LINK",
                                        "LIST",
                                        "LISTWISE",
                                        "LMATRIX",
                                        "LN",
                                        "LOCALE",
                                        "LOCATION",
                                        "LOG",
                                        "LOGIN",
                                        "LOSS",
                                        "LSL",
                                        "M-W",
                                        "MA",
                                        "MAKE",
                                        "MAP",
                                        "MAPOUTPUT",
                                        "MAPPINGS",
                                        "MAPPROJECTION",
                                        "MAPSPEC",
                                        "MARK",
                                        "MATRIX",
                                        "MAXCAT",
                                        "MAXCOUNT",
                                        "MAXITER",
                                        "MAXORDER",
                                        "MAXORDERS",
                                        "MCACHE",
                                        "MCGROUP",
                                        "MCNEMAR",
                                        "MDGROUP",
                                        "MDISPLAY",
                                        "MEAN",
                                        "MEASURE",
                                        "MEDIAN",
                                        "MEMALLOCATE",
                                        "MESSAGES",
                                        "MESTIMATORS",
                                        "METADATA",
                                        "METHOD",
                                        "MEXPAND",
                                        "MH",
                                        "MINIMUM",
                                        "MINRATE",
                                        "MINSAMPLE",
                                        "MIOUTPUT",
                                        "MISMATCH",
                                        "MISSING",
                                        "MISSINGSUMMARIES",
                                        "MITERATE",
                                        "MIXHOLD",
                                        "MMATRIX",
                                        "MNEST",
                                        "MODE",
                                        "MODEL",
                                        "MODELBUILDING",
                                        "MODELDETAILS",
                                        "MODELSTATISTICS",
                                        "MODELSUMMARY",
                                        "MODELSYSTEM",
                                        "MODELTABLES",
                                        "MOS",
                                        "MOSES",
                                        "MPATTERN",
                                        "MPRINT",
                                        "MRSETS",
                                        "MTINDEX",
                                        "MULTIPLESPACES",
                                        "MXAUTO",
                                        "MXCELLS",
                                        "MXCROSS",
                                        "MXERRS",
                                        "MXITER",
                                        "MXLAMB",
                                        "MXLOOPS",
                                        "MXMEMORY",
                                        "MXNEWVAR",
                                        "MXPREDICT",
                                        "MXWARNS",
                                        "N",
                                        "NAME",
                                        "NAMES",
                                        "NATRES",
                                        "NEWNAMES",
                                        "NEWVAR",
                                        "NEWVARS",
                                        "NOBSERVATIONS",
                                        "NOCONFORM",
                                        "NOCONSTANT",
                                        "NOLOG",
                                        "NONPARALLEL",
                                        "NOORIGIN",
                                        "NOPRINT",
                                        "NORMAL",
                                        "NORMALIZATION",
                                        "NORMALIZE",
                                        "NOSTANDARDIZE",
                                        "NOTABLE",
                                        "NOTOTAL",
                                        "NOUNIVARIATE",
                                        "NOWARN",
                                        "NP",
                                        "NTILES",
                                        "NTILES(k)",
                                        "NUMCLUSTERS",
                                        "OATTRS",
                                        "OBJECTPROPERTIES",
                                        "OBS",
                                        "OCCURS",
                                        "ODBCOPTIONS",
                                        "ODDSRATIOS",
                                        "ODISPLAY",
                                        "OLANG",
                                        "OMEANS",
                                        "ONESAMPLE",
                                        "ONUMBERS",
                                        "OPTIONS",
                                        "ORDERED",
                                        "ORIGIN",
                                        "OUTPUTFILTER",
                                        "OVARS",
                                        "P",
                                        "PACF",
                                        "PAIR",
                                        "PAIREDSAMPLES",
                                        "PAIRWISE",
                                        "PANEL",
                                        "PARAMETERS",
                                        "PAREPS",
                                        "PARETO",
                                        "PARTIALPLOT",
                                        "PARTITION",
                                        "PASSPROTECT",
                                        "PATTERN",
                                        "PCOMPS",
                                        "PCOMPUTE",
                                        "PDF",
                                        "PENALTY",
                                        "PERCENT",
                                        "PERCENTILES",
                                        "PERIOD",
                                        "PERMANENT",
                                        "PERMISSIONS",
                                        "PHI",
                                        "PIE",
                                        "PLAN",
                                        "PLANVARS",
                                        "PLOT",
                                        "PLOT MEANS",
                                        "PLOTS",
                                        "PLUGINS",
                                        "PMEANS",
                                        "PNG",
                                        "POINTLABEL",
                                        "POLYNOMIAL",
                                        "POPSIZE",
                                        "POSTHOC",
                                        "POWER",
                                        "PPROPERTIES",
                                        "PPT",
                                        "PRED",
                                        "PREDICT",
                                        "PREPDATETIME",
                                        "PRESORTED",
                                        "PRINT",
                                        "PRINTBACK",
                                        "PRIOR",
                                        "PRIORS",
                                        "PROFITS",
                                        "PROPORTION",
                                        "PROXIMITIES",
                                        "Q",
                                        "QUALIFIER",
                                        "QUEST",
                                        "RANDOM",
                                        "RANGE",
                                        "RANGES",
                                        "RANK",
                                        "RATE",
                                        "RATIO",
                                        "READNAMES",
                                        "RECORD",
                                        "RECORDS",
                                        "REFERENCE",
                                        "REG",
                                        "REGRESSION",
                                        "REGULARIZATION",
                                        "REGWGT",
                                        "RELATED",
                                        "RENAME",
                                        "REORDERNOMINAL",
                                        "REPDEFER",
                                        "REPEATED",
                                        "REPLACE",
                                        "REPLACEMISSING",
                                        "REPORT",
                                        "RESAMPLE",
                                        "RESCALE",
                                        "RESIDUALS",
                                        "RESTRICTIONS",
                                        "RESULTS",
                                        "RFRACTION",
                                        "RHO",
                                        "RNG",
                                        "ROBUST",
                                        "ROTATE",
                                        "ROTATION",
                                        "ROWSBREAK",
                                        "RULEGENERATION",
                                        "RULES",
                                        "RULESTABLE",
                                        "RULESUMMARIES",
                                        "RUNS",
                                        "SAMPLE",
                                        "SAMPLEFILE",
                                        "SAMPLING",
                                        "SAR",
                                        "SAVAGE",
                                        "SAVE",
                                        "SAVE TEMPLATE",
                                        "SCALE",
                                        "SCALEMIN",
                                        "SCATTER",
                                        "SCATTERPLOT",
                                        "SCENARIO",
                                        "SCENARIOGROUP",
                                        "SCENARIOPERIOD",
                                        "SCOMPRESSION",
                                        "SCORES",
                                        "SCREENING",
                                        "SD",
                                        "SDIFF",
                                        "SEASFACT",
                                        "SEASONAL",
                                        "SECURITY",
                                        "SEED",
                                        "SELECT",
                                        "SELECTRULE",
                                        "SEPARATOR",
                                        "SEQUENCE",
                                        "SERIESFILTER",
                                        "SERIESPLOT",
                                        "SERROR",
                                        "SERVER",
                                        "SETS",
                                        "SHAPE",
                                        "SHEET",
                                        "SHOWDIM",
                                        "SIGLESS",
                                        "SIGMAS",
                                        "SIGN",
                                        "SIGNIFICANCE",
                                        "SIGTEST",
                                        "SIMINPUT",
                                        "SIZE",
                                        "SKIP",
                                        "SLABELS",
                                        "SMA",
                                        "SMALL",
                                        "SMISSING",
                                        "SOL",
                                        "SORT",
                                        "SOURCE",
                                        "SP",
                                        "SPAN",
                                        "SPECFILE",
                                        "SPECIFICATION",
                                        "SPIKE",
                                        "SPLIT",
                                        "SPREAD",
                                        "SQ",
                                        "SRSESTIMATOR",
                                        "SSQPCT",
                                        "STACK",
                                        "STAGEVARS",
                                        "STANDARDIZE",
                                        "STARTS",
                                        "STATISTICS",
                                        "STATUS",
                                        "STOPCRITERIA",
                                        "STOPPINGRULES",
                                        "STRATA",
                                        "STRING",
                                        "STYLE",
                                        "SUBJECT",
                                        "SUBPOP",
                                        "SUBSET",
                                        "SUBTITLE",
                                        "SUCCESS",
                                        "SUM",
                                        "SUMMARY",
                                        "SUMMARYVAR",
                                        "SUPPLEMENTARY",
                                        "SURVIVALMETHOD",
                                        "SYSMIS",
                                        "SYSTEMOUTPUT",
                                        "TABLE",
                                        "TABLECELLS",
                                        "TABLERENDER",
                                        "TABLES",
                                        "TAG",
                                        "TARGET",
                                        "TARGETFILTER",
                                        "TARGETLIST",
                                        "TARGETOPTS",
                                        "TARGET_OPTIONS",
                                        "TEMPLATE",
                                        "TEST",
                                        "TESTASSUMPTIONS",
                                        "TESTVAL",
                                        "TEXT",
                                        "TEXTS",
                                        "THREADS",
                                        "TIF",
                                        "TIFT",
                                        "TIMEFIELDS",
                                        "TITLE",
                                        "TITLES",
                                        "TLOOK",
                                        "TMSRECORDING",
                                        "TNUMBERS",
                                        "TOLERANCE",
                                        "TORNADO",
                                        "TOTAL",
                                        "TPATTERN",
                                        "TRAILINGSPACES",
                                        "TRAININGSAMPLE",
                                        "TRANSFERFUNCTION",
                                        "TRANSFORM",
                                        "TRANSFORMATION",
                                        "TRANSFORMATIONS",
                                        "TREE",
                                        "TREND",
                                        "TSET",
                                        "TTEST",
                                        "TVARS",
                                        "TYPE",
                                        "U",
                                        "UNCOMPRESSED",
                                        "UNDEFINED",
                                        "UNENCRYPTED",
                                        "UNICODE",
                                        "UNSELECTED",
                                        "UPPERBOUND",
                                        "USL",
                                        "UTILITY",
                                        "VALIDATION",
                                        "VALIDLIST",
                                        "VALUELABELS",
                                        "VARCHECKS",
                                        "VARIABLES",
                                        "VARIANCES",
                                        "VARINFO",
                                        "VERSION",
                                        "VIEW",
                                        "VIEWMODEL",
                                        "VIEWNAME",
                                        "VIND",
                                        "VLABELS",
                                        "W-W",
                                        "WEIGHT",
                                        "WEIGHTS",
                                        "WIDTH",
                                        "WILCOXON",
                                        "WILD",
                                        "WINDOW",
                                        "WORDCLOUD",
                                        "WORKSPACE",
                                        "WRITE",
                                        "WSDESIGN",
                                        "WSFACTOR",
                                        "WSFACTORS",
                                        "X1",
                                        "X1LENGTH",
                                        "X2",
                                        "X2LENGTH",
                                        "XLS",
                                        "XR",
                                        "XS",
                                        "XVERSION",
                                        "Y",
                                        "YLENGTH",
                                        "ZCOMPRESSED",
                                        "ZCOMPRESSION"};

static const char *keyword_list[] = {"$CASE",
                                     "$COUNT",
                                     "$PCT",
                                     "(XBARONLY)",
                                     "(keyword)",
                                     ")CARD",
                                     ")DATE",
                                     ")JTIME",
                                     ")TABLE",
                                     "0BS",
                                     "1IN",
                                     "@ATTRIBUTES",
                                     "A",
                                     "AAD",
                                     "ABSOLUTE",
                                     "ACPROB",
                                     "ACTION",
                                     "ACTIVE",
                                     "AD1",
                                     "ADDITIVE",
                                     "ADDTYPE",
                                     "ADINORMALIZED",
                                     "ADJ",
                                     "ADJCHISQUARE",
                                     "ADJF",
                                     "ADJPRED",
                                     "ADJUST",
                                     "ADJUSTCORR",
                                     "ADJUSTEDRSQUARED",
                                     "AEMPIRICAL",
                                     "AFREQ",
                                     "AFTER",
                                     "AGGCOXSNELL",
                                     "AGGDEVIANCE",
                                     "AGGDFBETA",
                                     "AGGMARTINGALE",
                                     "AGGSCORE",
                                     "AIC",
                                     "AICC",
                                     "AINDS",
                                     "ALIGN",
                                     "ALIGNMENT",
                                     "ALLVARS",
                                     "ALPHA",
                                     "ANALYSIS",
                                     "ANALYSISTYPE",
                                     "ANALYSISVARS",
                                     "ANALYSISWEIGHT",
                                     "ANALYSIS_WEIGHT",
                                     "ANDREW",
                                     "ANOMALY",
                                     "ANOMALYCUTPOINT",
                                     "ANOMALYLIST",
                                     "ANOMALYSUMMARY",
                                     "ANOVA",
                                     "ANTIIDEAL",
                                     "APPLY",
                                     "APPROX",
                                     "APPROXIMATE",
                                     "AR",
                                     "AR1",
                                     "AREA",
                                     "AREALABEL",
                                     "ARH1",
                                     "ARMA11",
                                     "ASCAL",
                                     "ASCENDING",
                                     "ASE",
                                     "ASIS",
                                     "ASRESID",
                                     "ASSOCIATION",
                                     "ASYMMETRIC",
                                     "ASYMPTOTIC_CILEVEL",
                                     "ATTRIBUTES",
                                     "ATUO",
                                     "AUTHOR",
                                     "AUTO",
                                     "AUTOINIT",
                                     "AUTOMATIC",
                                     "AVALUE",
                                     "AVERF",
                                     "AVONLY",
                                     "AZLOUT",
                                     "AZOUT",
                                     "AZUOUT",
                                     "BACK",
                                     "BACKWARD",
                                     "BADCORR",
                                     "BAGGING",
                                     "BALANCED",
                                     "BANDWIDTH",
                                     "BAR",
                                     "BARBASE",
                                     "BART",
                                     "BARTLETT",
                                     "BASELINE",
                                     "BASELINESTRATA",
                                     "BASIS",
                                     "BATCH",
                                     "BAVERAGE",
                                     "BCOC",
                                     "BCON",
                                     "BCOV",
                                     "BESTSUBSET",
                                     "BESTSUBSETS",
                                     "BEUCLID",
                                     "BIAS",
                                     "BIC",
                                     "BIN",
                                     "BINNING",
                                     "BINOMIAL",
                                     "BINS",
                                     "BIPLOT",
                                     "BIVARIATE",
                                     "BLANK",
                                     "BLOCK",
                                     "BLOM",
                                     "BLWMN",
                                     "BONFERRONI",
                                     "BOOSTING",
                                     "BOOTSTRAP",
                                     "BOTH",
                                     "BOTTOM",
                                     "BOXBASE",
                                     "BOXCOX",
                                     "BOXM",
                                     "BOXPLOT",
                                     "BP",
                                     "BPROP",
                                     "BREAK",
                                     "BRESLOW",
                                     "BRIEF",
                                     "BRKSPACE",
                                     "BROWNFORSYTHE",
                                     "BSEUCLID",
                                     "BSHAPE",
                                     "BSTEP",
                                     "BTAU",
                                     "BTUKEY",
                                     "BYRULE",
                                     "BYVARIABLE",
                                     "C",
                                     "CALCULATE",
                                     "CANONICAL",
                                     "CAPSIGMA",
                                     "CAPSTYLE",
                                     "CAPTION",
                                     "CAPWIDTH",
                                     "CARD",
                                     "CASE",
                                     "CASECOUNT",
                                     "CASELIMIT",
                                     "CASENUM",
                                     "CASES",
                                     "CAT",
                                     "CATEGORICAL",
                                     "CATEGORIES",
                                     "CATEGORY",
                                     "CC CDF.NORMAL (function)",
                                     "CCW",
                                     "CD",
                                     "CDFORDER",
                                     "CELL",
                                     "CELLINFO",
                                     "CELLPROB",
                                     "CELLS",
                                     "CENTER",
                                     "CENTERED",
                                     "CENTR",
                                     "CENTROID",
                                     "CENTROIDS",
                                     "CHALIGN",
                                     "CHANGE",
                                     "CHARTFORMAT",
                                     "CHARTSIZE",
                                     "CHDSPACE",
                                     "CHEBYCHEV",
                                     "CHECKSEP",
                                     "CHISQ",
                                     "CHISQUARE",
                                     "CHKSEP",
                                     "CHWRAP",
                                     "CI",
                                     "CILEVEL",
                                     "CIMEANPREDL",
                                     "CIMEANPREDU",
                                     "CIN",
                                     "CINTERVAL",
                                     "CITYBLOCK",
                                     "CITYPE",
                                     "CITYPES",
                                     "CJUMP",
                                     "CKDER",
                                     "CLABELS",
                                     "CLASS",
                                     "CLASSICAL",
                                     "CLASSIFICATION",
                                     "CLASSIFY",
                                     "CLASSMISSING",
                                     "CLASSTABLE",
                                     "CLOGLOG",
                                     "CLOPPERPEARSON",
                                     "CLS",
                                     "CLUSTER",
                                     "CMEAN",
                                     "CMH",
                                     "CNAMES",
                                     "CO",
                                     "COCHRAN",
                                     "COD",
                                     "COEFF",
                                     "COINCIDENT",
                                     "COLCONF",
                                     "COLLECT",
                                     "COLLIN",
                                     "COLLINEARITY",
                                     "COLOP",
                                     "COLORS",
                                     "COLPCT",
                                     "COLSPACE",
                                     "COLUMN",
                                     "COLUMNS",
                                     "COLUMNWISE",
                                     "COLVAR",
                                     "COMBINED",
                                     "COMBINING_RULE_CONTINUOUS",
                                     "COMM",
                                     "COMMAND",
                                     "COMMON",
                                     "COMPARE",
                                     "COMPLETE",
                                     "COMPONENT_MODELS_N",
                                     "COMPOUND",
                                     "CONDENSE",
                                     "CONDENSED",
                                     "CONDITIONAL",
                                     "CONFIDENCE",
                                     "CONFIDENCE_INTERVALS",
                                     "CONFIDENCE_LEVEL",
                                     "CONFIDENCE_METHOD",
                                     "CONFIG",
                                     "CONSTANT",
                                     "CONSTRAIN",
                                     "CONSTRUCTION",
                                     "CONTRAST",
                                     "CONTRIBUTIONS",
                                     "CONTROL",
                                     "CONVERGE",
                                     "CONVERT",
                                     "COOK",
                                     "COORDINATES",
                                     "COR",
                                     "CORB",
                                     "CORNER",
                                     "CORR",
                                     "CORRELATION",
                                     "CORRELATIONS",
                                     "CORRESPONDENCE",
                                     "CORRMATRIX",
                                     "CORRTYPE",
                                     "COS",
                                     "COSINE",
                                     "COUNT",
                                     "COUNTDUPLICATES",
                                     "COUNTS",
                                     "COVARIANCE",
                                     "COVARIANCES",
                                     "COVARIANCE_TYPE",
                                     "COVARIATE",
                                     "COVARIATES",
                                     "COVB",
                                     "COVRATIO",
                                     "COVTYPE",
                                     "COXSNELL",
                                     "CP",
                                     "CPK",
                                     "CPL",
                                     "CPM",
                                     "CPOINTS",
                                     "CPRINCIPAL",
                                     "CPROFILES",
                                     "CPS",
                                     "CPU",
                                     "CR",
                                     "CRAMERSV",
                                     "CREATEMISPROPVAR",
                                     "CRITERIA_BEST_SUBSETS",
                                     "CRITERIA_FORWARD_STEPWISE",
                                     "CROSSVAL",
                                     "CROSSVALID",
                                     "CROSSVARRULES",
                                     "CRSHTOL",
                                     "CS",
                                     "CSH",
                                     "CSR",
                                     "CSTEP",
                                     "CSUM",
                                     "CTAU",
                                     "CTELLAREA",
                                     "CUBIC",
                                     "CUM",
                                     "CUMCAUCHIT",
                                     "CUMCLOGLOG",
                                     "CUMEVENT",
                                     "CUMHAZARD",
                                     "CUMLOGIT",
                                     "CUMNLOGLOG",
                                     "CUMPROB",
                                     "CUMPROBIT",
                                     "CUMULATIVE",
                                     "CUMWEIGHT",
                                     "CURRENT",
                                     "CURVE",
                                     "CUSTOM",
                                     "CUT",
                                     "CUTOFF",
                                     "CUTPOINT",
                                     "CV",
                                     "CW",
                                     "CYCLE",
                                     "CZL",
                                     "CZLOUT",
                                     "CZMAX",
                                     "CZMIN",
                                     "CZOoUT",
                                     "CZUOUT",
                                     "CoV",
                                     "CzU",
                                     "D",
                                     "DA",
                                     "DATA",
                                     "DATAFILTER",
                                     "DATASET",
                                     "DATEDURATION",
                                     "DAY",
                                     "DB3",
                                     "DB4",
                                     "DECOMPOSITION",
                                     "DEFAULT",
                                     "DEFAULTTEMPLATE",
                                     "DEFF",
                                     "DEFFSQRT",
                                     "DEGREE",
                                     "DELIMITED",
                                     "DELTA",
                                     "DENDROGRAM",
                                     "DENSITY",
                                     "DEPENDENT",
                                     "DERIVATIVES",
                                     "DESCENDING",
                                     "DESCRIBE",
                                     "DESCRIP",
                                     "DESCRIPTION",
                                     "DESCRIPTIVES",
                                     "DESIGN",
                                     "DET",
                                     "DETAILED",
                                     "DETRENDED",
                                     "DEV",
                                     "DEVIANCE",
                                     "DEVIANCERESID",
                                     "DEVIATION",
                                     "DF",
                                     "DFBETA",
                                     "DFE",
                                     "DFFIT",
                                     "DFFIXP",
                                     "DFMETHOD",
                                     "DFPRED",
                                     "DFREQ",
                                     "DIAG",
                                     "DIAGONAL",
                                     "DICE",
                                     "DICTIONARY",
                                     "DIFFERENCE",
                                     "DIFFSTRESS",
                                     "DIMENR",
                                     "DIMENS",
                                     "DIMENSIONS",
                                     "DIRECT",
                                     "DIRECTION",
                                     "DIRECTIONS",
                                     "DISCRDATA",
                                     "DISCRDATA(keyword)",
                                     "DISCRETE",
                                     "DISCRIM",
                                     "DISPER",
                                     "DISPLAY",
                                     "DISSIMILARITIES",
                                     "DISTANCE",
                                     "DISTANCES",
                                     "DISTR",
                                     "DISTRIBUTION",
                                     "DIVISOR",
                                     "DM",
                                     "DN",
                                     "DOCUMENTS",
                                     "DOT",
                                     "DOTLINE",
                                     "DOUBLE",
                                     "DOWN",
                                     "DRESID",
                                     "DROP",
                                     "DROPLINE",
                                     "DUMMY",
                                     "DUNCAN",
                                     "DUNNETT",
                                     "DUNNETTL",
                                     "DUNNETTR",
                                     "DUPLICATE",
                                     "DUPLICATEID",
                                     "DURBIN",
                                     "DVALUE",
                                     "Db2",
                                     "EA",
                                     "ECONVERGE",
                                     "EDITABLE",
                                     "EFFECTS",
                                     "EFRON",
                                     "EFSIZE",
                                     "EIGEN",
                                     "ELLCOORD",
                                     "EM",
                                     "EMPIRICAL",
                                     "EMPTY",
                                     "EMPTYCASE",
                                     "EMS",
                                     "EN",
                                     "ENCODING",
                                     "ENCRYPTEDPW",
                                     "ENDPOINTS",
                                     "ENET",
                                     "ENTER",
                                     "ENTROPY",
                                     "ENTRYMETHOD",
                                     "EPANECHNIKOV",
                                     "EPS",
                                     "EQINTV",
                                     "EQUAL",
                                     "EQUAL_WOR",
                                     "EQUAMAX",
                                     "ERROR",
                                     "ERRORBAR",
                                     "ERRORCHANGE",
                                     "ERRORRATIO",
                                     "ERRORSTEPS",
                                     "ESTIM",
                                     "ESTPROB",
                                     "ETA",
                                     "ETASQ",
                                     "EUCLID",
                                     "EUCLIDEAN",
                                     "EVALUATIONFIELDS",
                                     "EVENTINFO",
                                     "EXACT",
                                     "EXACTSIZE",
                                     "EXCEPT",
                                     "EXCHANGEABLE",
                                     "EXCLUDE",
                                     "EXCLUDED",
                                     "EXP",
                                     "EXPECTED",
                                     "EXPERIMENTAL",
                                     "EXPIRATION",
                                     "EXPONENTIAL",
                                     "EXTRACAT",
                                     "EXTRACTDAY",
                                     "EXTRACTHOUR",
                                     "EXTRACTION",
                                     "EXTRACTMINUTE",
                                     "EXTRACTMONTH",
                                     "EXTRACTSECOND",
                                     "EXTRACTYEAR",
                                     "EXTREME",
                                     "F",
                                     "FA1",
                                     "FACTOR",
                                     "FACTORS",
                                     "FAH1",
                                     "FANCY",
                                     "FCSITERATIONS",
                                     "FEATURES",
                                     "FIELD",
                                     "FILE",
                                     "FILELABEL",
                                     "FIN",
                                     "FIRST",
                                     "FISHER",
                                     "FIT",
                                     "FITS",
                                     "FIXED",
                                     "FIXPRED",
                                     "FIXSIGNS",
                                     "FLATWGHT",
                                     "FLIMIT",
                                     "FNAMES",
                                     "FOCALCASES",
                                     "FOLD",
                                     "FOLDS",
                                     "FOOTNOTE",
                                     "FOR",
                                     "FORCEMERGE",
                                     "FORMAT",
                                     "FORMATS",
                                     "FORWARD",
                                     "FORWARDSTEPWISE",
                                     "FOUT",
                                     "FPAIR",
                                     "FPRECISION",
                                     "FREE",
                                     "FREGW",
                                     "FREQ",
                                     "FREQUENCIES",
                                     "FREQUENCY",
                                     "FRIEDMAN",
                                     "FROM",
                                     "FSCORE",
                                     "FSTEP",
                                     "FTOLERANCE",
                                     "FTSPACE",
                                     "FULL",
                                     "G",
                                     "GABRIEL",
                                     "GAC",
                                     "GAIN",
                                     "GAMMA",
                                     "GCOV",
                                     "GEF",
                                     "GEMSCAL",
                                     "GEMWGHT",
                                     "GENERALIZED",
                                     "GEOMETRIC",
                                     "GG",
                                     "GH",
                                     "GLS",
                                     "GMEDIAN",
                                     "GOODFIT",
                                     "GPC",
                                     "GRADIENTDESCENT",
                                     "GRID",
                                     "GROUP",
                                     "GROUPED",
                                     "GROUPING",
                                     "GROUPS",
                                     "GROUPWISE",
                                     "GROWTH",
                                     "GT2",
                                     "GUIDE",
                                     "GUTTMAN",
                                     "HAMANN",
                                     "HAMMING",
                                     "HAMPEL",
                                     "HARMONIC",
                                     "HAVERAGE",
                                     "HAZARD",
                                     "HCONVERGE",
                                     "HEADER",
                                     "HELMERT",
                                     "HF",
                                     "HICICLE",
                                     "HIDDENFUNCTION",
                                     "HIDDENLAYERS",
                                     "HIDENOTSIG",
                                     "HIDESOURCECATS",
                                     "HIERARCHICAL",
                                     "HIGH",
                                     "HIGHEST",
                                     "HILO",
                                     "HISTOGRAM",
                                     "HISTORY",
                                     "HODGES_LEHMAN",
                                     "HOLD",
                                     "HOLDOUT",
                                     "HOLT",
                                     "HOMOGENEITY",
                                     "HORIZONTAL",
                                     "HOTELLING",
                                     "HOUR",
                                     "HUBER",
                                     "HYPOTH",
                                     "IBY",
                                     "IC",
                                     "ICHAREND",
                                     "ICIN",
                                     "ICMDEND",
                                     "ID",
                                     "IDEAL",
                                     "IDEFAULT",
                                     "IDENTITY",
                                     "IELL",
                                     "IELSE",
                                     "IENCLOSE",
                                     "IGAUSS",
                                     "IGNORE_CASE",
                                     "IMAGE",
                                     "IMAGEMAP",
                                     "IMAGEROOT",
                                     "IMAGES",
                                     "IMPORTANCE",
                                     "IMPUTATIONS",
                                     "IN",
                                     "INCLPROB",
                                     "INCLUDE",
                                     "INCOMPLETE",
                                     "INCOMPLETEID",
                                     "INDENT",
                                     "INDEPENDENCE",
                                     "INDEPENDENT",
                                     "INDEX",
                                     "INDICATOR",
                                     "INDIVIDUAL",
                                     "INDSCAL",
                                     "INITIAL",
                                     "INITTHRESHOLD",
                                     "INKNOT",
                                     "INLINE",
                                     "INOEXPAND",
                                     "INPUT",
                                     "INPUTS",
                                     "INSIDE",
                                     "INTERACTIONS",
                                     "INTERCEPT",
                                     "INTERCOOLED",
                                     "INTERPOLATE",
                                     "INTERVAL",
                                     "INTERVALCENTER",
                                     "INTERVALOFFSET",
                                     "INTO",
                                     "INV",
                                     "INVERSE",
                                     "IOFFEXPAND",
                                     "IONEXPAND",
                                     "IPOSITIONAL",
                                     "ISTEP",
                                     "ITER",
                                     "ITERATE",
                                     "ITERATIONS",
                                     "ITHEN",
                                     "ITO",
                                     "ITOKENS",
                                     "JACCARD",
                                     "JEFFREYS",
                                     "JITTER",
                                     "JOIN",
                                     "JOINT",
                                     "JOINTCAT",
                                     "JONCKHEERE_TERPSTRA",
                                     "K",
                                     "K1",
                                     "K2",
                                     "KAISER",
                                     "KAPPA",
                                     "KEEP",
                                     "KEEPTIES",
                                     "KENDALL",
                                     "KERNEL",
                                     "KEY",
                                     "KEYWORDS",
                                     "KMATRIX",
                                     "KMEANS",
                                     "KMO",
                                     "KOLMOGOROV_SMIRNOV",
                                     "KRUSKAL_WALLIS",
                                     "KURT",
                                     "KURTOSIS",
                                     "KeywordName",
                                     "L MATRIX",
                                     "LA",
                                     "LABEL",
                                     "LABELS",
                                     "LAGRANGE",
                                     "LAGRANGE3",
                                     "LAGRANGES5",
                                     "LAMBDA",
                                     "LAMBDAINITIAL",
                                     "LARGE",
                                     "LASSO",
                                     "LAST",
                                     "LATENTFACTORS",
                                     "LAYERED",
                                     "LCL_CUMHAZARD",
                                     "LCL_SURVIVAL",
                                     "LCON",
                                     "LCONVERGE",
                                     "LDELLAREA",
                                     "LEARNINGEPOCHS",
                                     "LEARNINGINITIAL",
                                     "LEARNINGLOWER",
                                     "LEFT",
                                     "LEGEND",
                                     "LENGTH",
                                     "LESS",
                                     "LEVEL",
                                     "LEVER",
                                     "LEVERAGE",
                                     "LFTOLERANCE",
                                     "LG10",
                                     "LGSTIC",
                                     "LIFT",
                                     "LIKELIHOOD",
                                     "LIKELIHOODRESID",
                                     "LIMIT",
                                     "LINE",
                                     "LINEAR",
                                     "LINEARITY",
                                     "LINELABEL",
                                     "LINK",
                                     "LINKPARAMETER",
                                     "LIST",
                                     "LISTING",
                                     "LISTWISE",
                                     "LJUMP",
                                     "LLEFT",
                                     "LLR",
                                     "LM",
                                     "LMATRIX",
                                     "LML",
                                     "LN",
                                     "LOADING",
                                     "LOADINGS",
                                     "LOCATION",
                                     "LOCK",
                                     "LOF",
                                     "LOG",
                                     "LOGARITHMIC",
                                     "LOGC",
                                     "LOGIT",
                                     "LOGRANK",
                                     "LOGSURV",
                                     "LOSS",
                                     "LOW",
                                     "LOWER",
                                     "LOWEREND",
                                     "LOWERLIMIT",
                                     "LOWEST",
                                     "LR",
                                     "LRCHISQ",
                                     "LRESID",
                                     "LRIGHT",
                                     "LRT",
                                     "LSD",
                                     "LSL",
                                     "LSTEP",
                                     "LSTOLERANCE",
                                     "MACROS",
                                     "MAHAL",
                                     "MANN_WHITNEY",
                                     "MANUAL",
                                     "MAP",
                                     "MARGINAL_HOMOGENEITY",
                                     "MARGINS",
                                     "MARKERS",
                                     "MARTINGALE",
                                     "MAT",
                                     "MATRIX",
                                     "MAX",
                                     "MAXCASEDRAWS",
                                     "MAXCASES",
                                     "MAXCAT",
                                     "MAXCATS",
                                     "MAXEFFECT",
                                     "MAXEPOCHS",
                                     "MAXIMUM",
                                     "MAXITER",
                                     "MAXITERATIONS",
                                     "MAXMINF",
                                     "MAXMODELPARAM",
                                     "MAXNUMPEERS",
                                     "MAXPARAMDRAWS",
                                     "MAXPCTMISSING",
                                     "MAXSIZE",
                                     "MAXSTEPHALVING",
                                     "MAXSTEPS",
                                     "MAXUNITS",
                                     "MAXVALORDINAL",
                                     "MAX_CATEGORIES",
                                     "MAX_EFFECTS",
                                     "MAX_STEPS",
                                     "MBP",
                                     "MC",
                                     "MCA",
                                     "MCIN",
                                     "MCNEMAR",
                                     "MC_CILEVEL",
                                     "MDCOV",
                                     "MDEPENDENT",
                                     "MDGROUP",
                                     "MEAN",
                                     "MEANPRED",
                                     "MEANS",
                                     "MEANSUBSTITUTION",
                                     "MEASURE",
                                     "MEASURES",
                                     "MEDIAN",
                                     "MEFFECT",
                                     "MEMALLOCATE",
                                     "MEMSIZE",
                                     "MERGESUPERVISED",
                                     "MERGEUNSUPERVISED",
                                     "METHOD",
                                     "METRIC",
                                     "MFI",
                                     "MIDPOINT",
                                     "MIN",
                                     "MINEFFECT",
                                     "MINEIGEN",
                                     "MINIBATCH",
                                     "MINIBATCHSIZE",
                                     "MINIMUM",
                                     "MINKOWSKI",
                                     "MINMAX",
                                     "MINNUMPEERS",
                                     "MINORITERATION",
                                     "MINPCT",
                                     "MINQUE",
                                     "MINRESID",
                                     "MINSTRESS",
                                     "MINUNITS",
                                     "MINUTE",
                                     "MINVALCONTINUOUS",
                                     "MINVIOLATIONS",
                                     "MISSING",
                                     "MIXED",
                                     "ML",
                                     "MLE",
                                     "MLEVEL",
                                     "MLWEIGHT",
                                     "MNCOV",
                                     "MNOM",
                                     "MODE",
                                     "MODEIMPU",
                                     "MODEL",
                                     "MODELFORMAT",
                                     "MODELINFO",
                                     "MODELQUALITY",
                                     "MODELS",
                                     "MODEL_SELECTION",
                                     "MOMENTUM",
                                     "MONTH",
                                     "MORE",
                                     "MOSES",
                                     "MRBAR",
                                     "MRGROUP",
                                     "MRSETS",
                                     "MSE",
                                     "MULTINOMIAL",
                                     "MULTIPLE",
                                     "MULTIPLICATIVE",
                                     "MULTIPLYING",
                                     "MULTIPUNCH",
                                     "MULTISTART",
                                     "MULTIV",
                                     "MUPLUS",
                                     "MWITHIN",
                                     "MXBRANCH",
                                     "MXITER",
                                     "MXLEVEL",
                                     "MXSTEP",
                                     "N",
                                     "NA",
                                     "NAME",
                                     "NAMES",
                                     "NCASES",
                                     "NCAT",
                                     "NCOMP",
                                     "NDIM",
                                     "NEGATIVE",
                                     "NEGBIN",
                                     "NEIGHBORS",
                                     "NEQ",
                                     "NESTED",
                                     "NETWORK",
                                     "NETWORKINFO",
                                     "NEWTON",
                                     "NFTOLERANCE",
                                     "NGE",
                                     "NGT",
                                     "NIMPUTATIONS",
                                     "NIN",
                                     "NLE",
                                     "NLOGLOG",
                                     "NLT",
                                     "NM",
                                     "NN",
                                     "NO",
                                     "NOCASENUM",
                                     "NOCONSTANT",
                                     "NOCOUNTS",
                                     "NOCUM",
                                     "NODF",
                                     "NODIAGONAL",
                                     "NOFILL",
                                     "NOINITIAL",
                                     "NOINT",
                                     "NOJOIN",
                                     "NOKAISER",
                                     "NOLABELS",
                                     "NOLIST",
                                     "NOLOG",
                                     "NOMEANS",
                                     "NOMI",
                                     "NOMINAL",
                                     "NONAME",
                                     "NONE",
                                     "NONMISSING",
                                     "NONORMAL",
                                     "NOPROB",
                                     "NOREFERENCE",
                                     "NOREPORT",
                                     "NORMAL",
                                     "NORMALIZED",
                                     "NORMPLOT",
                                     "NORMPROB",
                                     "NORMS",
                                     "NOROTATE",
                                     "NOSELECTION",
                                     "NOSIG",
                                     "NOSORT",
                                     "NOTABLE",
                                     "NOTABLES",
                                     "NOTOTAL",
                                     "NOULB",
                                     "NOWARN",
                                     "NPCT",
                                     "NPCT(var)",
                                     "NPPLOT",
                                     "NPREDICTORS",
                                     "NRBF",
                                     "NSAMPLES",
                                     "NUM",
                                     "NUMANOMALOUSCASES",
                                     "NUMBERED",
                                     "NUME",
                                     "NUMERICAL",
                                     "NUMFEATURES",
                                     "NUMIN",
                                     "NUMREASONS",
                                     "NUMUNITS",
                                     "N_MATRIX",
                                     "N_SCALAR",
                                     "N_VECTOR",
                                     "OBELISK",
                                     "OBELLAREA",
                                     "OBJECT",
                                     "OBJECTIVE",
                                     "OBLIMIN",
                                     "OBSVALPROB",
                                     "OCHIAI",
                                     "OCORR",
                                     "ODBC",
                                     "ODDSPOWER",
                                     "ODDSRATIO",
                                     "OF",
                                     "OFF",
                                     "OFFSET",
                                     "OLEDB",
                                     "OMEGA",
                                     "OMS",
                                     "ONEBREAKCOLUMN",
                                     "ONEPAGE",
                                     "ONETAIL",
                                     "ONLINE",
                                     "ONLY",
                                     "OPOWER",
                                     "OPRINCIPAL",
                                     "OPTIMAL",
                                     "OPTIMIZATION",
                                     "OPTOL",
                                     "OPTOLERANCE",
                                     "ORBF",
                                     "ORDER",
                                     "ORDI",
                                     "ORDINAL",
                                     "ORIGIN",
                                     "ORIGINAL",
                                     "ORTHONORM",
                                     "OTHER",
                                     "OUT",
                                     "OUTPUTFUNCTION",
                                     "OUTS",
                                     "OUTSIDE",
                                     "OVERALL",
                                     "OVERLAP",
                                     "OVERLAY",
                                     "OVERLAYTARGETS",
                                     "P",
                                     "P-P",
                                     "PA1",
                                     "PA2",
                                     "PADJUST",
                                     "PAF",
                                     "PAGE",
                                     "PAIR",
                                     "PAIRED",
                                     "PARALL",
                                     "PARALLEL",
                                     "PARAMETER",
                                     "PARAMETERS",
                                     "PARTITION",
                                     "PARZEN",
                                     "PASSIVE",
                                     "PASSWORD",
                                     "PATTERN",
                                     "PATTERNS",
                                     "PC",
                                     "PCON",
                                     "PCONVERGE",
                                     "PCPROB",
                                     "PCT",
                                     "PCTANOMALOUSCASES",
                                     "PCTEQUAL",
                                     "PCTMISSING",
                                     "PCTONECASE",
                                     "PCTUNEQUAL",
                                     "PEARSON",
                                     "PEARSONCHISQ",
                                     "PEARSONRESID",
                                     "PEARSON_RESIDUALS",
                                     "PEERID",
                                     "PEERPCTSIZE",
                                     "PEERSIZE",
                                     "PEQ",
                                     "PER",
                                     "PERCENT",
                                     "PERCENTILES",
                                     "PERMUTATION",
                                     "PERVIOUSWEIGHT",
                                     "PGE",
                                     "PGROUP",
                                     "PGT",
                                     "PH",
                                     "PH2",
                                     "PHI",
                                     "PIE",
                                     "PIN",
                                     "PLAIN",
                                     "PLAN",
                                     "PLE",
                                     "PLOT",
                                     "PLT",
                                     "POISSON",
                                     "POLYNOMIAL",
                                     "POOL",
                                     "POOLED",
                                     "POPSIZE",
                                     "POSITION",
                                     "POUT",
                                     "POWER",
                                     "PP",
                                     "PPK",
                                     "PPL",
                                     "PPM",
                                     "PPS_BREWER",
                                     "PPS_CHROMY",
                                     "PPS_MURTHY",
                                     "PPS_SAMPFORD",
                                     "PPS_SYSTEMATIC",
                                     "PPS_WOR",
                                     "PPS_WR",
                                     "PPU",
                                     "PR",
                                     "PRD",
                                     "PRED",
                                     "PREDCAT",
                                     "PREDICTED",
                                     "PREDICTED_PROBABILITY",
                                     "PREDICTED_VALUES",
                                     "PREDICTORS",
                                     "PREDPROB",
                                     "PREDVAL",
                                     "PREDVALPROB",
                                     "PREPAREDDATA",
                                     "PREPROCESS",
                                     "PREPXML",
                                     "PRESID",
                                     "PRESORTED",
                                     "PREVIEW",
                                     "PREVIOUS",
                                     "PRINCIPAL",
                                     "PRINTERPOLATE",
                                     "PROB",
                                     "PROBABILITY_ENTRY",
                                     "PROBABILITY_REMOVAL",
                                     "PROBIT",
                                     "PROBS",
                                     "PROCRU",
                                     "PRODUCTLIMIT",
                                     "PROFILE",
                                     "PROFILES",
                                     "PROJCENTR(keyword)",
                                     "PROMAX",
                                     "PROP",
                                     "PROPHAZARD",
                                     "PROPORTION",
                                     "PROX",
                                     "PROXIMITIES",
                                     "PSEUDOBIC",
                                     "PSEUDOPROB",
                                     "PTILE",
                                     "PVALUE",
                                     "PW",
                                     "PYRAMID",
                                     "PZL",
                                     "PZLOUT",
                                     "PZMAX",
                                     "PZMIN",
                                     "PZOUT",
                                     "PZU",
                                     "PZUOUT",
                                     "Q",
                                     "Q-Q",
                                     "QREGW",
                                     "QS",
                                     "QUADRATIC",
                                     "QUANT",
                                     "QUARTILES",
                                     "QUARTIMAX",
                                     "R",
                                     "RANDIMPU",
                                     "RANDOM",
                                     "RANGE",
                                     "RANKING",
                                     "RANKIT",
                                     "RAO",
                                     "RATE",
                                     "RATIO",
                                     "RAW",
                                     "RBAR",
                                     "RC",
                                     "RCMEAN",
                                     "RCON",
                                     "RCONF",
                                     "RCONVERGE",
                                     "REASONMEASURE",
                                     "REASONNORM",
                                     "REASONSUMMARY",
                                     "REASONVALUE",
                                     "REASONVAR",
                                     "RECTANGLE",
                                     "RECTANGULAR",
                                     "REDUCED",
                                     "REDUNDANCY",
                                     "REFCAT",
                                     "REFERENCE",
                                     "REFLEC",
                                     "REG",
                                     "REGRESSION",
                                     "REGU",
                                     "RELATIVE",
                                     "RELRISK",
                                     "REML",
                                     "REMOVALMETHOD",
                                     "REMOVE",
                                     "RENAMEVARS",
                                     "REPEATED",
                                     "REPEATED_MEASURES",
                                     "REPLACEWITH",
                                     "REPLICATE_RESULTS",
                                     "REPORT",
                                     "REPORTEMPTY",
                                     "REPORTMISSING",
                                     "REPR",
                                     "REPRESULTS",
                                     "REREAD",
                                     "RES",
                                     "RESCALE",
                                     "RESERVEDATTRIBUTES",
                                     "RESID",
                                     "RESIDUAL",
                                     "RESIDUALS",
                                     "RESPONSES",
                                     "REVERSE",
                                     "RIDGE",
                                     "RIGHT",
                                     "RISK",
                                     "RISKDIFF",
                                     "RISKINFO",
                                     "RIUMP",
                                     "RLABELS",
                                     "RMEAN",
                                     "RMP",
                                     "RNAMES",
                                     "RND",
                                     "ROBUST",
                                     "ROC",
                                     "ROLE",
                                     "ROLES",
                                     "ROTATE",
                                     "ROTATION",
                                     "ROUND",
                                     "ROW",
                                     "ROWCONF",
                                     "ROWOP",
                                     "ROWPCT",
                                     "ROWS",
                                     "ROWSIZE",
                                     "ROWVAR",
                                     "RPOINTS",
                                     "RPRINCIPAL",
                                     "RPROFILES",
                                     "RR",
                                     "RSSCP",
                                     "RSTEP",
                                     "RSUM",
                                     "RT",
                                     "RULE",
                                     "RULES",
                                     "RULEVIOLATIONS",
                                     "RUNS",
                                     "S",
                                     "SAMPLE",
                                     "SAMPLEINFO",
                                     "SAMPLEMEAN",
                                     "SAMPLEMEDIAN",
                                     "SAMPLES",
                                     "SAMPLEWEIGHT",
                                     "SAMPSIZE",
                                     "SAS",
                                     "SAVE",
                                     "SCALEDCONJUGATE",
                                     "SCALEMODEL",
                                     "SCALEWEIGHT",
                                     "SCHEDULE",
                                     "SCHEFFE",
                                     "SCHOENEMANN",
                                     "SCHOENFELD",
                                     "SCOPE",
                                     "SCORE",
                                     "SCORES",
                                     "SCORING",
                                     "SCRATCH",
                                     "SD",
                                     "SDBETA",
                                     "SDFIT",
                                     "SDRESID",
                                     "SE",
                                     "SECOND",
                                     "SEED",
                                     "SEFIXP",
                                     "SEKURT",
                                     "SELECT",
                                     "SELECTED",
                                     "SELECTION",
                                     "SELIRT",
                                     "SEMEAN",
                                     "SEPARATE",
                                     "SEPRED",
                                     "SEQBONFERRONI",
                                     "SEQSIDAK",
                                     "SERIAL",
                                     "SES",
                                     "SESKEW",
                                     "SETDIAG",
                                     "SEUCLID",
                                     "SHAPE",
                                     "SHOWREFLINE",
                                     "SHOWUNSELECTED",
                                     "SIDAK",
                                     "SIDE",
                                     "SIG",
                                     "SIGMAINITIAL",
                                     "SIGMOID",
                                     "SIGN",
                                     "SIGNIF",
                                     "SIMILARITIES",
                                     "SIMPLE",
                                     "SIMPLEX",
                                     "SIMPLE_CHROMY",
                                     "SIMPLE_SYSTEMATIC",
                                     "SIMPLE_WOR",
                                     "SIMPLE_WR",
                                     "SIMULATION",
                                     "SIMULATIONS",
                                     "SIN",
                                     "SINGLE",
                                     "SINGLECAT",
                                     "SINGLEDF",
                                     "SINGULAR",
                                     "SIZE",
                                     "SKEW",
                                     "SKEWNESS",
                                     "SKIP",
                                     "SLICE",
                                     "SLK",
                                     "SM",
                                     "SMOOTH",
                                     "SNAMES",
                                     "SNK",
                                     "SNOM",
                                     "SOFTMAX",
                                     "SOLUTION",
                                     "SORT",
                                     "SORTED",
                                     "SOURCE",
                                     "SOURCES",
                                     "SPACE",
                                     "SPCT",
                                     "SPCT(var)",
                                     "SPEARMAN",
                                     "SPECIAL",
                                     "SPECIFICATIONS",
                                     "SPLINE",
                                     "SPLIT",
                                     "SPNOM",
                                     "SPORD",
                                     "SPREADLEVEL",
                                     "SP_EXPONENTIAL",
                                     "SP_GAUSSIAN",
                                     "SP_LINEAR",
                                     "SP_LINEARLOG",
                                     "SP_POWER",
                                     "SP_SPHERICAL",
                                     "SQUARE",
                                     "SRESID",
                                     "SS",
                                     "SSCON",
                                     "SSCP",
                                     "SSTYPE",
                                     "STACK",
                                     "STACKED",
                                     "STAN",
                                     "STANDARDIZED",
                                     "START",
                                     "STATA",
                                     "STATE",
                                     "STATUS",
                                     "STDDEV",
                                     "STDDEVIANCERESID",
                                     "STDPEARSONRESID",
                                     "STEMLEAF",
                                     "STEP",
                                     "STEPDOWN",
                                     "STEPLIMIT",
                                     "STEPWISE",
                                     "STERROR",
                                     "STIMWGHT",
                                     "STRAIGHT",
                                     "STRATA",
                                     "STRESS",
                                     "STRESSMIN",
                                     "STRICTPARALLEL",
                                     "STRINGS",
                                     "STRUCTURE",
                                     "STYLE",
                                     "SUBJECT",
                                     "SUBJECTS",
                                     "SUBJWGHT",
                                     "SUBTITLE",
                                     "SUCCESS",
                                     "SUFFIX",
                                     "SUM",
                                     "SUMAV",
                                     "SUMMARY",
                                     "SUMSPACE",
                                     "SUMSQ",
                                     "SUPERVISED",
                                     "SURVIVAL",
                                     "SVD",
                                     "SYM",
                                     "SYMBOL",
                                     "SYMMETRIC",
                                     "SYMMETRICAL",
                                     "SYNTAX",
                                     "SYSMIS",
                                     "T",
                                     "T2",
                                     "T3",
                                     "TAB",
                                     "TABLE",
                                     "TABLEPCT",
                                     "TABLES",
                                     "TANH",
                                     "TAPE",
                                     "TARGET",
                                     "TARGETFILTER",
                                     "TARONE",
                                     "TCOV",
                                     "TDF",
                                     "TEMPLATE",
                                     "TEST",
                                     "TEST(ESTIMABLE)",
                                     "TEST(LMATRIX)",
                                     "TEST(MMATRIX)",
                                     "TEST(SSCP)",
                                     "TEST(TRANSFORM)",
                                     "TESTCOV",
                                     "TESTDATA",
                                     "TESTING",
                                     "TESTPOS",
                                     "TESTTYPES",
                                     "TESTVAL",
                                     "TESTVALUE",
                                     "TEXTIN",
                                     "THREE",
                                     "THRESH",
                                     "THRU",
                                     "TIES",
                                     "TIESTORE",
                                     "TIMEDURATION",
                                     "TIMER",
                                     "TITLE",
                                     "TOLERANCE",
                                     "TOP",
                                     "TOPICS",
                                     "TORGERSON",
                                     "TOTAL",
                                     "TP",
                                     "TPH",
                                     "TRAINING",
                                     "TRAININGTIMER",
                                     "TRANS",
                                     "TRANSFORM",
                                     "TRANSFORMATION",
                                     "TRANSFORMATIONS",
                                     "TRANSFORMED",
                                     "TRCOLUMNS",
                                     "TRDATA",
                                     "TREEFORMAT",
                                     "TRIANGLE",
                                     "TRIMOUTLIERS",
                                     "TRIPLOT",
                                     "TRROWS",
                                     "TRUNCATE",
                                     "TSPACE",
                                     "TTEST",
                                     "TUKEY",
                                     "TWEEDIE",
                                     "TWOTAIL",
                                     "TXT",
                                     "TYPE",
                                     "UC",
                                     "UCL_CUMHAZARD",
                                     "UCL_SURVIVAL",
                                     "ULEFT",
                                     "ULS",
                                     "UN",
                                     "UNBALANCED",
                                     "UNCLASSIFIED",
                                     "UNCONDITIONAL",
                                     "UNDERSCORE",
                                     "UNEQUAL_WOR",
                                     "UNIFORM",
                                     "UNIQUE",
                                     "UNIQUECAT",
                                     "UNIT",
                                     "UNIV",
                                     "UNIVARIATE",
                                     "UNIVF",
                                     "UNNUMBERED",
                                     "UNR",
                                     "UNSELECTED",
                                     "UNSTRUCTURED",
                                     "UNTIE",
                                     "UN_AR1",
                                     "UN_CS",
                                     "UN_UN",
                                     "UP",
                                     "UPDATECORR",
                                     "UPPER",
                                     "UPPEREND",
                                     "URIGHT",
                                     "USE",
                                     "USERMISSING",
                                     "USE_AUTO_DATA_PREPARATION",
                                     "USL",
                                     "VAC",
                                     "VAF",
                                     "VAL",
                                     "VALLABELS",
                                     "VALUE",
                                     "VALUELABELS",
                                     "VAR",
                                     "VAREST",
                                     "VARIABLE",
                                     "VARIABLEINFO",
                                     "VARIABLES",
                                     "VARIANCE",
                                     "VARIMAX",
                                     "VARORDER",
                                     "VC",
                                     "VECTOR",
                                     "VERSIONLABEL",
                                     "VERTICAL",
                                     "VICICLE",
                                     "VIEW",
                                     "VIZMAP",
                                     "VIZSTYLESHEET",
                                     "VPC",
                                     "VPRINCIPAL",
                                     "VS",
                                     "VW",
                                     "WALD",
                                     "WALD_WOLFOWITZ",
                                     "WALLER",
                                     "WARD",
                                     "WARN",
                                     "WAVERAGE",
                                     "WCOC",
                                     "WEEK",
                                     "WEIGHT",
                                     "WEIGHTED",
                                     "WEIGHTFEATURES",
                                     "WEIGHTING",
                                     "WEIGHTS",
                                     "WELCH",
                                     "WGTMEAN",
                                     "WHISKER",
                                     "WHITE",
                                     "WIDTH",
                                     "WILCOXON",
                                     "WILKS",
                                     "WINTERS",
                                     "WITHIN",
                                     "WITHINSUBJECT",
                                     "WK1",
                                     "WKS",
                                     "WOR",
                                     "WORKINGCORR",
                                     "WPRED",
                                     "WR",
                                     "WRAP",
                                     "WRESID",
                                     "X1INTERVAL",
                                     "X1MULTIPLIER",
                                     "X1START",
                                     "X2INTERVAL",
                                     "X2MULTIPLIER",
                                     "X2START",
                                     "XBETA",
                                     "XBPRED",
                                     "XBSTDERROR",
                                     "XLS",
                                     "XLSM",
                                     "XLSX",
                                     "XPROD",
                                     "XTX",
                                     "XYZ",
                                     "Y",
                                     "YEAR",
                                     "YES",
                                     "Z",
                                     "ZCORR",
                                     "ZPP",
                                     "ZPRED",
                                     "ZRESID",
                                     "ZSCORE"};

static const size_t NUM_COMMANDS =
    sizeof(command_list) / sizeof(command_list[0]);

static const size_t NUM_SUBCOMMANDS =
    sizeof(subcommand_list) / sizeof(subcommand_list[0]);

static const size_t NUM_KEYWORDS =
    sizeof(keyword_list) / sizeof(keyword_list[0]);

//---------------------------------------------------------------------
// Helper: checks if a character is allowed in a command name.
// (Letters, digits, spaces, and '-' are allowed.)
static inline bool is_command_char(int32_t c) {
  return c != 0 && (isalpha(c) || isdigit(c) || c == ' ' || c == '-');
}

//---------------------------------------------------------------------
// The external scanner function.
// It advances through the input while tracking candidates that match
// one of our fixed command names. When a candidate is complete (i.e. pos
// equals the candidate’s length) we mark that as a potential match.
// However, we do not immediately stop if the next character is a valid
// command character—if any candidate remains that could extend the match,
// we continue scanning.
bool tree_sitter_spss_external_scanner_scan(void *payload, TSLexer *lexer,
                                            const bool *valid_symbols) {
  if ((!valid_symbols[ID]) && (!valid_symbols[SUBID]) && (!valid_symbols[KEY]))
    return false;

  while (isspace(lexer->lookahead))
    lexer->advance(lexer, true);

  // Check for an optional slash only if SUBID is valid.
  bool has_slash = false;
  if (valid_symbols[SUBID] && lexer->lookahead == '/') {
    has_slash = true;
    lexer->advance(lexer, false);
  }

  // Initialize candidate arrays.
  bool candidate_possible_cmd[NUM_COMMANDS];
  for (size_t i = 0; i < NUM_COMMANDS; i++)
    candidate_possible_cmd[i] = true;

  bool candidate_possible_subcmd[NUM_SUBCOMMANDS];
  for (size_t i = 0; i < NUM_SUBCOMMANDS; i++)
    candidate_possible_subcmd[i] = true;

  bool candidate_possible_keyword[NUM_KEYWORDS];
  for (size_t i = 0; i < NUM_KEYWORDS; i++)
    candidate_possible_keyword[i] = true;

  // pos counts the number of ch
  size_t pos = 0;
  size_t best_cmd_length = 0;
  size_t best_subcmd_length = 0;
  size_t best_key_length = 0;
  bool found_complete_cmd = false;
  bool found_complete_subcmd = false;
  bool found_complete_keyword = false;

  while (true) {
    int32_t lookahead = lexer->lookahead;
    if (lookahead == 0)
      break;

    bool any_possible = false;

    // Update command candidates.
    for (size_t i = 0; i < NUM_COMMANDS; i++) {
      if (!candidate_possible_cmd[i])
        continue;
      size_t len = strlen(command_list[i]);
      if (pos < len) {
        char expected = command_list[i][pos];
        // NOTE: Case-sensitive
        if (lookahead != expected)
          // NOTE: Case-insensitive
          // if (tolower(lookahead) != tolower(expected))
          candidate_possible_cmd[i] = false;
      }
      if (candidate_possible_cmd[i])
        any_possible = true;
    }

    // Update subcommand candidates.
    for (size_t i = 0; i < NUM_SUBCOMMANDS; i++) {
      if (!candidate_possible_subcmd[i])
        continue;
      size_t len = strlen(subcommand_list[i]);
      if (pos < len) {
        char expected = subcommand_list[i][pos];
        // NOTE: Case-sensitive
        if (lookahead != expected)
          // NOTE: Case-insensitive
          // if (tolower(lookahead) != tolower(expected))
          candidate_possible_subcmd[i] = false;
      }
      if (candidate_possible_subcmd[i])
        any_possible = true;
    }

    // Update keyword candidates.
    for (size_t i = 0; i < NUM_KEYWORDS; i++) {
      if (!candidate_possible_keyword[i])
        continue;
      size_t len = strlen(keyword_list[i]);
      if (pos < len) {
        char expected = keyword_list[i][pos];
        // NOTE: Case-sensitive
        if (lookahead != expected)
          // NOTE: Case-insensitive
          // if (tolower(lookahead) != tolower(expected))
          candidate_possible_keyword[i] = false;
      }
      if (candidate_possible_keyword[i])
        any_possible = true;
    }

    // Check for complete command candidates.
    bool current_complete_cmd = false;
    for (size_t i = 0; i < NUM_COMMANDS; i++) {
      if (!candidate_possible_cmd[i])
        continue;
      size_t len = strlen(command_list[i]);
      if (pos == len) {
        current_complete_cmd = true;
        if (len > best_cmd_length)
          best_cmd_length = len;
      }
    }
    if (current_complete_cmd)
      found_complete_cmd = true;

    // Check for complete subcommand candidates.
    bool current_complete_subcmd = false;
    for (size_t i = 0; i < NUM_SUBCOMMANDS; i++) {
      if (!candidate_possible_subcmd[i])
        continue;
      size_t len = strlen(subcommand_list[i]);
      if (pos == len) {
        current_complete_subcmd = true;
        if (len > best_subcmd_length)
          best_subcmd_length = len;
      }
    }
    if (current_complete_subcmd)
      found_complete_subcmd = true;

    // Check for complete keyword candidates.
    bool current_complete_keyword = false;
    for (size_t i = 0; i < NUM_COMMANDS; i++) {
      if (!candidate_possible_keyword[i])
        continue;
      size_t len = strlen(keyword_list[i]);
      if (pos == len) {
        current_complete_keyword = true;
        if (len > best_key_length)
          best_key_length = len;
      }
    }
    if (current_complete_keyword)
      found_complete_keyword = true;

    bool ambiguous_cmd = false;
    for (size_t i = 0; i < NUM_COMMANDS; i++) {
      if (candidate_possible_cmd[i] && strlen(command_list[i]) > pos)
        ambiguous_cmd = true;
    }

    bool ambiguous_subcmd = false;
    for (size_t i = 0; i < NUM_SUBCOMMANDS; i++) {
      if (candidate_possible_subcmd[i] && strlen(subcommand_list[i]) > pos)
        ambiguous_subcmd = true;
    }

    bool ambiguous_keyword = false;
    for (size_t i = 0; i < NUM_SUBCOMMANDS; i++) {
      if (candidate_possible_keyword[i] && strlen(keyword_list[i]) > pos)
        ambiguous_keyword = true;
    }

    // Only break if a command candidate is complete and unambiguous,
    // OR if no command candidate remains and a subcommand candidate is complete
    // and unambiguous.
    if ((found_complete_cmd && !ambiguous_cmd) ||
        (!found_complete_cmd && found_complete_subcmd && !ambiguous_subcmd &&
         !ambiguous_cmd) ||
        (!found_complete_cmd && !found_complete_subcmd &&
         found_complete_keyword && !ambiguous_keyword))
      break;

    if (!any_possible)
      break;

    lexer->advance(lexer, false);
    pos++;
  }

  // No valid match found.
  if (!found_complete_cmd && !found_complete_subcmd && !found_complete_keyword)
    return false;

  // If a subcommand match occurred, adjust its length to include the slash.
  if (has_slash)
    best_subcmd_length += 1;

  size_t token_length = pos; // how many characters were consumed
  if (token_length <= 1) {
    return false;
  }

  bool is_valid_next_char =
      (lexer->lookahead == 0 || lexer->lookahead == '=' ||
       lexer->lookahead == '.' || isspace(lexer->lookahead));

  // Decide which token to emit.
  // If both complete matches exist, choose the one with the longer match.
  if ((found_complete_cmd && valid_symbols[ID] &&
       (!found_complete_subcmd || best_cmd_length >= best_subcmd_length)) ||
      (!found_complete_subcmd && valid_symbols[ID])) {
    lexer->mark_end(lexer);
    lexer->result_symbol = ID;
    return true;
  } else if ((found_complete_subcmd && valid_symbols[SUBID] &&
              !found_complete_cmd)) {
    lexer->mark_end(lexer);
    if (!is_valid_next_char)
      return false;
    lexer->result_symbol = SUBID;
    return true;
  } else if (found_complete_keyword && valid_symbols[KEY] &&
             !found_complete_cmd && !found_complete_subcmd) {
    lexer->mark_end(lexer);
    if (!is_valid_next_char)
      return false;
    lexer->result_symbol = KEY;
    return true;
  }
  return false;
}

//---------------------------------------------------------------------
// Scanner state management functions.
void *tree_sitter_spss_external_scanner_create(void) { return NULL; }
void tree_sitter_spss_external_scanner_destroy(void *payload) { (void)payload; }
unsigned tree_sitter_spss_external_scanner_serialize(void *payload,
                                                     char *buffer) {
  (void)payload;
  (void)buffer;
  return 0;
}
void tree_sitter_spss_external_scanner_deserialize(void *payload,
                                                   const char *buffer,
                                                   unsigned length) {
  (void)payload;
  (void)buffer;
  (void)length;
}
